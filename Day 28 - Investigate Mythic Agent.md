### 1. Introduction

**Goal:** Understand how to investigate activity generated by the Mythic C2 framework and identify key indicators of compromise. Focus on correlating process, network, and file events to map a C2 session.

---

### 2. Accessing Events

- Navigate to the Discover section, set the time frame to 30 days and search for the Mythic C2 agent executable `svchost-emaan.exe`.
- Sorting events from old to new helped follow the sequence of activities generated by the agent.
- The events included both process creations and network connections, giving insight into the C2’s operational timeline. We can check the dashboards we created in day 22.

![[Pasted image 20251020013515.png]]

- Table shows suspicious **PowerShell activities**.
- Agent name isn’t obviously suspicious, but behavior is unusual.
- Executable running from **Public Downloads** connecting to an **IP via HTTP** is suspicious and unusual.
- Normally, check IP on **threat intelligence tools**, but it’s our **Mythic server**, so won’t appear as malicious.
- **Three processes** all connected to the same IP (our Mythic server) → red flag.

Key starting points for investigation: **suspicious executable** + **destination IP**.

---

### 3. Identifying C2 Activity

- **Network Telemetry:** Multiple back-and-forth connections were observed between the agent and the Mythic server. High byte transfers indicated active command sessions.
    
- **Heartbeat & Process Tracking:** Using Sysmon event ID 3, network creations were correlated with process launches to identify which processes were responsible for C2 communication.
    
- Suspicious processes included PowerShell sessions and executables in unusual directories like `C:\Users\Public\Downloads`.
    


---

### 4. Observations from Active Agent

- The second Mythic agent remained active and allowed execution of shell commands such as `ipconfig`, `dir`, and `mkdir Assignments`.
    
- Running commands directly through the C2 console created separate PowerShell sessions, producing distinct logs each time.
    
- The agent was executing from `C:\Users\Public\Downloads`, a non-standard location for legitimate binaries, marking it suspicious.
    

---

### 5. Event Correlation and Timeline

- I identified three network connection events to the Mythic server IP. Using the first event as a starting point, I copied the `ProcessGUID` to correlate all events originating from the same PowerShell session.
    
- File creation events appeared immediately after network connection events, confirming agent deployment.
    
- Sysmon event ID 29 logs allowed extraction of the executable’s hash.
    
- Parent-child relationships were observed between PowerShell sessions and the Mythic agent process, helping map the sequence of actions.
    
- Different `ProcessGUIDs` were noted for shell commands executed via the C2, indicating that each command spawned a new console session.
    

---

### 6. Key Findings

- Credential reads and discovery commands were consistently logged during C2 activity.
    
- Windows Defender was disabled during the activity window, showing attempts to bypass AV protections.
    
- Network connections were established to the Mythic server on standard HTTP ports, confirming exfiltration or command channels.
    
- File creation logs confirmed the deployment of the agent binary.
    
- ParentProcessGuid and ProcessGUID correlations provided a clear timeline for each session and command executed.
    

---

### 7. Alerting and Ticketing Integration

- A Mythic agent detection rule was configured to push alerts via Webhook to the ticketing system (example: osTicket).
    
- A custom detection rule was created for `cmd.exe` process creations initiated by users (excluding `NT AUTHORITY\SYSTEM`) to capture shell commands executed through the C2.
    
- Alerts included fields such as process name, user, and timestamps for easier triage.
    
- Testing confirmed that running commands like `whoami` through the C2 triggered alerts successfully, validating the detection and integration setup.
    

---

### 8. Conclusion

- The investigation highlighted how Mythic C2 activity leaves correlated traces across processes, files, and network connections.
    
- Tracking `ProcessGUID` and parent-child relationships was essential to reconstruct command execution sequences.
    
- Using dashboards to visualize process-initiated network connections and filtering by relevant providers simplified identifying suspicious activity.
    
- Documenting the timeline of events provided a clear understanding of the agent’s lifecycle and operational footprint.

**Reference**
https://youtu.be/b11TuDx_CjU?si=0l7G0t4JCNZ-yv5C